############################################################
#
# $Id$
#
# Copyright (c) scixtracer 2021
#
# AUTHOR:
# Sylvain Prigent
# 

# Project name
project(scixtracercpp)

## #################################################################
## Define files
## #################################################################

SET(SRC_FILES  
  SxData.cpp
  SxDataset.cpp
  SxDate.cpp
  SxExperiment.cpp
  SxFormat.cpp
  SxLog.cpp
  SxLogFile.cpp
  SxLogTerminal.cpp
  SxMetadata.cpp
  SxObject.cpp
  SxProcessedData.cpp
  SxRawData.cpp
  SxRequest.cpp
  SxRequestLocal.cpp
  SxRun.cpp
  SxSearch.cpp
  SxSearchContainer.cpp
  SxSerialize.cpp
  SxSerializeJson.cpp
  SxServices.cpp
  SxSettings.cpp
  SxContainer.cpp
  SxTags.cpp
  SxUser.cpp
)

SET(HEADERS_FILES
  SxData.h
  SxDataset.h
  SxDate.h
  SxExperiment.h
  SxFormat.h
  SxException.h
  SxLog.h
  SxLogFile.h
  SxLogTerminal.h
  SxMetadata.h
  SxObject.h
  SxProcessedData.h
  SxRawData.h
  SxRequest.h
  SxRequestLocal.h
  SxRun.h
  SxSearch.h
  SxSearchContainer.h
  SxSerialize.h
  SxSerializeJson.h
  SxServices.h
  SxSettings.h
  SxContainer.h
  SxTags.h
  SxUser.h
)
  
## #################################################################
## Library target
## #################################################################

add_library(${PROJECT_NAME} ${SRC_FILES} ${HEADERS_FILES})

target_link_libraries(${PROJECT_NAME} ${SL_LIBRARIES})


## #################################################################
## Export header file
## #################################################################

set(CMAKE_CXX_VISIBILITY_PRESET hidden)
set(CMAKE_VISIBILITY_INLINES_HIDDEN 1)

generate_export_header(${PROJECT_NAME}
  EXPORT_FILE_NAME "${PROJECT_NAME}Export.h")

add_custom_command(TARGET ${PROJECT_NAME} PRE_BUILD
  COMMAND ${CMAKE_COMMAND} ARGS -E copy_if_different "${${PROJECT_NAME}_BINARY_DIR}/${PROJECT_NAME}Export.h" "${CMAKE_BINARY_DIR}"
  COMMAND ${CMAKE_COMMAND} ARGS -E copy_if_different "${${PROJECT_NAME}_BINARY_DIR}/${PROJECT_NAME}Export.h" "${CMAKE_BINARY_DIR}/${PROJECT_NAME}Export")
